
function md5_crypt(a,b){if(typeof VarType!="undefined"){a=VarType.toStr(a);b=VarType.toStr(b)}var c=b64pad;b64pad="";var d=chrsz;chrsz=8;var e="$1$";if(b.substr(0,e.length)==e){b=b.substr(e.length)}var f=b.indexOf("$");if(f<0||f>8)f=8;b=b.substr(0,f);var g=a+e+b;var h=str_md5(a+b+a);for(var f=a.length;f>0;f-=16){if(f>=16){g+=h}else{g+=h.substr(0,f)}}for(var f=a.length;f!=0;f=f>>1){if((f&1)!=0){g+=String.fromCharCode(0)}else{g+=a.charAt(0)}}var i=e+b+"$";h=str_md5(g);for(f=0;f<1e3;f++){g="";if((f&1)!=0)g+=a;else g+=h;if(f%3!=0)g+=b;if(f%7!=0)g+=a;if((f&1)!=0)g+=h;else g+=a;h=str_md5(g)}h+=h.charAt(5);var j;for(var f=0;f<5;f++){j=h.charCodeAt(f)<<16|h.charCodeAt(f+6)<<8|h.charCodeAt(f+12);i+=md5_to64(j,4)}j=h.charCodeAt(11);i+=md5_to64(j,2);b64pad=c;chrsz=d;return i}function md5_to64(a,b){if(typeof VarType!="undefined"){a=VarType.toUInt(a);b=VarType.toUInt(b)}var c="./0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz";var d="";while(--b>=0){d+=c.charAt(a&63);a=a>>6}return d}
